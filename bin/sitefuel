#!/usr/bin/ruby -wrubygems

# == Synopsis
#
# A lightweight ruby framework for processing and deploying websites, either
# from
#
# == Usage
#
#  sitefuel deploy|process SOURCE [OPTIONS]
#
# == Introduction
# SiteFuel is a program and lightweight Ruby API for processing the
# source code behind your static and dynamic websites. SiteFuel can
# remove comments and unneeded whitespace from your CSS, HTML, and
# JavaScript files (as well as fragments in RHTML and PHP) files. It can
# also loss-lessly compress your PNG and JPEG images. SiteFuel can also
# deploy your website from SVN or GIT.
#
# Support for more formats and repositories is planned for future versions.
#
# * More information: http://sitefuel.org
# * Getting started: http://sitefuel.org/getstarted
# * Documentation: http://sitefuel.org/documentation
#
# == Commands
#
# deploy::      Deploy a site using sitefuel.
# process::     Modify an existing website in-place.
# stage::       Simulates a deployment without actually changing anything.
# help::        Show this message.
#
# == Examples
# Process an already deployed site:
#  sitefuel process /var/www/
#
# Deploy a site from SVN:
#  sitefuel deploy svn+ssh://sitefuel.org/svn/tags/21 /var/www/
#
# Specify a non-default deployment file:
#  sitefuel process /var/www/ -c customdeployment.yml
#
#
# == Author
# wkm, Zanoccio LLC.
#
# == Copyright
# Copyright (c) 2009 Zanoccio.
#
# == License
# This program is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License
# as published by the Free Software Foundation; either version 2
# of the License, or (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
#

# add source/ to the load path
$:.unshift File.join(File.dirname(__FILE__), "..", "lib")

begin
  begin
    require 'rubygems'
  rescue LoadError
    # attempt to continue running the program
  end

  require 'sitefuel/SiteFuelRuntime'
  require 'sitefuel/CommandLine'

  def main
    runtime = SiteFuel::SiteFuelRuntime.new
    SiteFuel::CommandLine::parse_command_line(runtime)
  end

  main()

rescue Interrupt
  puts 'Fatal: interrupted. Exiting.'
end